<!DOCTYPE html>
<html lang="fr">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <title>Z-SURVIVAL: VRAIE VERSION FINALE</title>
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
Â  Â  <style>
Â  Â  Â  Â  /* REPRISE INTÃ‰GRALE DU CSS DE GAME FINISHH 4 */
Â  Â  Â  Â  body { margin: 0; background: #050505; color: white; font-family: 'Segoe UI', sans-serif; overflow: hidden; display: flex; align-items: center; justify-content: center; height: 100vh; touch-action: none; }
Â  Â  Â  Â  #game-container { position: relative; border: 4px solid #222; box-shadow: 0 0 100px #000; width: 900px; height: 650px; background: #1a3d1a; }
Â  Â  Â  Â  canvas { display: block; image-rendering: pixelated; width: 100%; height: 100%; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* HUD ORIGINAL */
Â  Â  Â  Â  #hud, #kill-counter { position: absolute; pointer-events: none; display: none; z-index: 10; scale: 0.9; }
Â  Â  Â  Â  #hud { top: 20px; left: 20px; }
Â  Â  Â  Â  #kill-counter { top: 20px; right: 20px; text-align: right; }
Â  Â  Â  Â  .stat-box { background: rgba(0,0,0,0.85); padding: 12px; border-radius: 10px; border: 1px solid rgba(255,255,255,0.1); margin-bottom: 8px; min-width: 180px; }
Â  Â  Â  Â  .bar-bg { background: #222; height: 10px; border-radius: 5px; overflow: hidden; margin-top: 5px; }
Â  Â  Â  Â  #hp-fill { width: 100%; height: 100%; background: linear-gradient(90deg, #ff416c, #ff4b2b); transition: 0.2s; }
Â  Â  Â  Â  .rank-badge { padding: 5px 15px; border-radius: 4px; font-weight: 900; font-size: 14px; text-transform: uppercase; border: 2px solid; background: #333; border-color: #555; color: #aaa; }

Â  Â  Â  Â  /* CONTRÃ”LES MOBILES DISCRETS */
Â  Â  Â  Â  .mobile-ui { position: absolute; z-index: 50; user-select: none; }
Â  Â  Â  Â  #joy-base { bottom: 40px; left: 40px; width: 120px; height: 120px; background: rgba(255,255,255,0.1); border-radius: 50%; border: 1px solid rgba(255,255,255,0.2); }
Â  Â  Â  Â  #joy-stick { position: absolute; top: 35px; left: 35px; width: 50px; height: 50px; background: rgba(255,255,255,0.3); border-radius: 50%; }
Â  Â  Â  Â  #btns { bottom: 40px; right: 20px; display: flex; flex-direction: column; gap: 10px; }
Â  Â  Â  Â  .btn-m { width: 80px; height: 80px; border-radius: 50%; background: rgba(231, 76, 60, 0.4); border: 2px solid white; color: white; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 12px; }

Â  Â  Â  Â  #start-screen { position: absolute; inset: 0; background: radial-gradient(circle, #2c3e50, #000); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 100; }
Â  Â  </style>
</head>
<body>

<div id="game-container">
Â  Â  <div id="start-screen">
Â  Â  Â  Â  <h1 style="font-size: 50px; color:#e74c3c; margin:0;">Z-SURVIVAL</h1>
Â  Â  Â  Â  <button style="background:#e74c3c; color:white; padding:15px 40px; border:none; border-radius:30px; font-weight:bold; margin-top:20px;" onclick="startGame()">LANCER MOBILE</button>
Â  Â  </div>

Â  Â  <div id="hud">
Â  Â  Â  Â  <div class="stat-box"><small>SANTÃ‰</small><div class="bar-bg"><div id="hp-fill"></div></div></div>
Â  Â  Â  Â  <div class="stat-box" style="border-left: 4px solid #f1c40f;">
Â  Â  Â  Â  Â  Â  <div style="color:#f1c40f;">ðŸ’° <span id="money">100</span> $</div>
Â  Â  Â  Â  Â  Â  <div style="color:#2ecc71; font-size: 13px;">ðŸŒµ CACTUS : <span id="cactus-qty">0</span></div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div id="kill-counter">
Â  Â  Â  Â  <div id="rank-display" class="rank-badge">DÃ‰BUTANT</div>
Â  Â  Â  Â  <div class="stat-box">ðŸ’€ <span id="current-kills">0</span><br><small>RECORD: 345</small></div>
Â  Â  </div>

Â  Â  <div id="joy-base" class="mobile-ui"><div id="joy-stick"></div></div>
Â  Â  <div id="btns" class="mobile-ui">
Â  Â  Â  Â  <div class="btn-m" style="width:100px; height:100px; background:rgba(231,76,60,0.6);" id="fire">TIRER</div>
Â  Â  Â  Â  <div class="btn-m" onclick="pickup(); shopAction();">ACTION</div>
Â  Â  Â  Â  <div class="btn-m" onclick="eat();">SOIN</div>
Â  Â  </div>

Â  Â  <canvas id="game" width="900" height="650"></canvas>
</div>

<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');

// VARIABLES (COPIE CONFORME GAME FINISHH 4)
let isRunning = false, map = "DEHORS";
let stats = { hp: 100, money: 100, cactus: 0, kills: 0, speed: 4.5 };
let player = { x: 450, y: 325, walkFrame: 0, weapon: null };
let zombies = [], bullets = [], particles = [], items = [{x: 150, y: 500, type: 'sword', name: 'KATANA'}, {x: 750, y: 150, type: 'gun', name: 'FUSIL M4'}];
let joy = { active: false, x: 0, y: 0, angle: 0 };

// JOYSTICK MOBILE
const jBase = document.getElementById('joy-base');
const jStick = document.getElementById('joy-stick');
jBase.addEventListener('touchstart', (e) => { joy.active = true; });
window.addEventListener('touchmove', (e) => {
Â  Â  if(!joy.active) return;
Â  Â  let t = e.touches[0];
Â  Â  let r = jBase.getBoundingClientRect();
Â  Â  let dx = t.clientX - (r.left + 60);
Â  Â  let dy = t.clientY - (r.top + 60);
Â  Â  let d = Math.min(Math.hypot(dx, dy), 45);
Â  Â  joy.angle = Math.atan2(dy, dx);
Â  Â  joy.x = Math.cos(joy.angle) * (d/45);
Â  Â  joy.y = Math.sin(joy.angle) * (d/45);
Â  Â  jStick.style.transform = `translate(${joy.x*45}px, ${joy.y*45}px)`;
});
window.addEventListener('touchend', () => { joy.active = false; joy.x = joy.y = 0; jStick.style.transform = 'translate(0,0)'; });
document.getElementById('fire').addEventListener('touchstart', (e) => { e.preventDefault(); attack(); });

// DESSIN DU SHOP EXACT (IMAGE DE DROITE)
function drawShop() {
Â  Â  let mx = 350, my = 80, mw = 200, mh = 150;
Â  Â  // Murs avec planches
Â  Â  ctx.fillStyle = "#4e342e"; ctx.fillRect(mx, my, mw, mh);
Â  Â  ctx.fillStyle = "#3e2723"; for(let i=0; i<mh; i+=15) ctx.fillRect(mx, my+i, mw, 2);
Â  Â  // Toit Rouge TexturÃ©
Â  Â  ctx.fillStyle = "#c0392b"; ctx.beginPath(); ctx.moveTo(mx-30, my); ctx.lineTo(mx+mw/2, my-80); ctx.lineTo(mx+mw+30, my); ctx.fill();
Â  Â  // FenÃªtres blanches (le dÃ©tail qui manquait !)
Â  Â  ctx.fillStyle = "#add8e6"; ctx.fillRect(mx+20, my+30, 40, 40); ctx.fillRect(mx+mw-60, my+30, 40, 40);
Â  Â  ctx.strokeStyle = "#fff"; ctx.lineWidth = 2; ctx.strokeRect(mx+20, my+30, 40, 40); ctx.strokeRect(mx+mw-60, my+30, 40, 40);
Â  Â  // Porte bleue
Â  Â  ctx.fillStyle = "#3498db"; ctx.fillRect(mx+mw/2-40, my+80, 80, 70);
Â  Â  // Lampes oranges
Â  Â  ctx.fillStyle = "#f39c12"; ctx.beginPath(); ctx.arc(mx+50, my+100, 5, 0, Math.PI*2); ctx.arc(mx+mw-50, my+100, 5, 0, Math.PI*2); ctx.fill();
Â  Â  // Texte SHOP
Â  Â  ctx.fillStyle = "#f1c40f"; ctx.font = "bold 24px 'Courier New'"; ctx.fillText("S H O P", mx+55, my-20);
}

// ZOMBIES AVEC BRAS (IMAGE DE DROITE)
function drawZombie(x, y, frame) {
Â  Â  let move = Math.sin(frame)*5;
Â  Â  ctx.fillStyle = "rgba(0,0,0,0.3)"; ctx.beginPath(); ctx.ellipse(x+20, y+50, 15, 6, 0, 0, 7); ctx.fill();
Â  Â  ctx.fillStyle = "#4a7c44"; ctx.fillRect(x+5, y+15, 30, 35);
Â  Â  ctx.fillStyle = "#74a57f"; ctx.fillRect(x+10, y, 20, 20);
Â  Â  // Yeux verts
Â  Â  ctx.fillStyle = "#0f0"; ctx.fillRect(x+13, y+6, 5, 5); ctx.fillRect(x+22, y+6, 5, 5);
Â  Â  // Bras tendus (comme sur l'image de droite !)
Â  Â  ctx.fillStyle = "#74a57f"; ctx.fillRect(x-8, y+20+move, 15, 8); ctx.fillRect(x+33, y+20-move, 15, 8);
}

function render() {
Â  Â  if(!isRunning) return;
Â  Â  ctx.clearRect(0,0,900,650);
Â  Â  if(map === "DEHORS") {
Â  Â  Â  Â  ctx.fillStyle = "#2d5a27"; ctx.fillRect(0,0,900,650);
Â  Â  Â  Â  drawShop();
Â  Â  Â  Â  if(joy.active) { player.x += joy.x * stats.speed; player.y += joy.y * stats.speed; player.walkFrame += 0.2; }
Â  Â  Â  Â  if(Math.random() < 0.01) zombies.push({x: Math.random()*900, y: -50, f: 0});
Â  Â  Â  Â  zombies.forEach((z, zi) => {
Â  Â  Â  Â  Â  Â  let a = Math.atan2(player.y - z.y, player.x - z.x);
Â  Â  Â  Â  Â  Â  z.x += Math.cos(a)*1.7; z.y += Math.sin(a)*1.7; z.f += 0.1;
Â  Â  Â  Â  Â  Â  drawZombie(z.x, z.y, z.f);
Â  Â  Â  Â  Â  Â  if(Math.hypot(player.x-z.x, player.y-z.y) < 35) { stats.hp -= 0.4; updateUI(); }
Â  Â  Â  Â  });
Â  Â  Â  Â  bullets.forEach((b, i) => {
Â  Â  Â  Â  Â  Â  b.x += b.vx; b.y += b.vy; ctx.fillStyle = "#ff0"; ctx.fillRect(b.x, b.y, 8, 3);
Â  Â  Â  Â  Â  Â  zombies.forEach((z, zi) => { if(Math.hypot(b.x-z.x-20, b.y-z.y-20) < 30) { zombies.splice(zi,1); bullets.splice(i,1); stats.money+=50; stats.kills++; updateUI(); } });
Â  Â  Â  Â  });
Â  Â  Â  Â  items.forEach(it => { ctx.fillStyle="white"; ctx.fillText(it.name+" [E]", it.x-15, it.y-15); ctx.fillRect(it.x, it.y, 30, 10); });
Â  Â  Â  Â  if(player.y < 230 && player.x > 400 && player.x < 500) { map = "MAGASIN"; player.y = 550; }
Â  Â  } else {
Â  Â  Â  Â  ctx.fillStyle = "#111"; ctx.fillRect(0,0,900,650);
Â  Â  Â  Â  ctx.fillStyle = "white"; ctx.fillText("ENOHA LE MARCHAND (SOIN 50$)", 300, 140);
Â  Â  Â  Â  if(joy.y > 0.5) { map = "DEHORS"; player.y = 260; }
Â  Â  }
Â  Â  // JOUEUR
Â  Â  let bob = Math.sin(player.walkFrame)*4;
Â  Â  ctx.fillStyle = "#34495e"; ctx.fillRect(player.x+5, player.y+15+bob, 30, 32);
Â  Â  ctx.fillStyle = "#ffdbac"; ctx.fillRect(player.x+10, player.y+bob, 20, 20);
Â  Â  if(player.weapon) { ctx.fillStyle="#111"; ctx.fillRect(player.x+15, player.y+25+bob, 30, 8); }

Â  Â  if(stats.hp <= 0) location.reload();
Â  Â  requestAnimationFrame(render);
}

function attack() { if(!player.weapon || map !== "DEHORS") return; let a = joy.active ? joy.angle : 0; bullets.push({x: player.x+20, y: player.y+20, vx: Math.cos(a)*15, vy: Math.sin(a)*15}); }
function pickup() { items.forEach((it, i) => { if(Math.hypot(player.x-it.x, player.y-it.y)<60) { player.weapon=it; items.splice(i,1); } }); }
function eat() { if(stats.cactus > 0) { stats.cactus--; stats.hp = Math.min(100, stats.hp+25); updateUI(); } }
function shopAction() { if(map === "MAGASIN" && stats.money >= 50) { stats.money -= 50; stats.cactus++; updateUI(); } }
function startGame() { document.getElementById('start-screen').style.display='none'; document.getElementById('hud').style.display='block'; document.getElementById('kill-counter').style.display='block'; isRunning=true; render(); }
function updateUI() { document.getElementById('hp-fill').style.width = stats.hp+"%"; document.getElementById('money').innerText = stats.money; document.getElementById('cactus-qty').innerText = stats.cactus; document.getElementById('current-kills').innerText = stats.kills; }
</script>
</body>
</html>
